{"remainingRequest":"/Users/apple/Desktop/vueprototype/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/apple/Desktop/vueprototype/src/pages/layout/navbar.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/apple/Desktop/vueprototype/src/pages/layout/navbar.vue","mtime":1599616394000},{"path":"/Users/apple/Desktop/vueprototype/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/apple/Desktop/vueprototype/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/apple/Desktop/vueprototype/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/apple/Desktop/vueprototype/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcFN0YXRlIH0gZnJvbSAidnVleCI7CmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhICgpIHsKICAgIGxldCB2YWxpZGF0ZVBhc3MgPSAocnVsZSwgdmFsdWUsIGNhbGxiYWNrKSA9PiB7CiAgICAgIGlmICh2YWx1ZSA9PT0gIiIpIHsKICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoIuivt+i+k+WFpeaWsOWvhueggSIpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAodGhpcy5mb3JtLmNoZWNrUGFzc3dvcmQgIT09ICIiKSB7CiAgICAgICAgICB0aGlzLiRyZWZzLnJ1bGVGb3JtLnZhbGlkYXRlRmllbGQoImNoZWNrUGFzcyIpOwogICAgICAgIH0KICAgICAgICBjYWxsYmFjaygpOwogICAgICB9CiAgICB9OwogICAgbGV0IHZhbGlkYXRlUGFzczIgPSAocnVsZSwgdmFsdWUsIGNhbGxiYWNrKSA9PiB7CiAgICAgIGlmICh2YWx1ZSA9PT0gIiIpIHsKICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoIuivt+WGjeasoei+k+WFpeWvhueggSIpKTsKICAgICAgfSBlbHNlIGlmICh2YWx1ZSAhPT0gdGhpcy5mb3JtLm5ld1Bhc3N3b3JkKSB7CiAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKCLkuKTmrKHovpPlhaXlr4bnoIHkuI3kuIDoh7QhIikpOwogICAgICB9IGVsc2UgewogICAgICAgIGNhbGxiYWNrKCk7CiAgICAgIH0KICAgIH07CiAgICByZXR1cm4gewogICAgICBkaWFsb2dGb3JtVmlzaWJsZTpmYWxzZSwKICAgICAgZm9ybUxhYmVsV2lkdGg6JzEwMHB4JywKICAgICAgZm9ybTp7CiAgICAgICAgb2xkUGFzc3dvcmQ6ICcnLAogICAgICAgIG5ld1Bhc3N3b3JkOicnLAogICAgICAgIGNoZWNrUGFzc3dvcmQ6JycKICAgICAgfSwKICAgICAgcnVsZXM6ewogICAgICAgIG9sZFBhc3N3b3JkOiBbe3JlcXVpcmVkOnRydWUsdHJpZ2dlcjonYmx1cicsbWVzc2FnZTon6K+36L6T5YWl5pen5a+G56CBJ31dLAogICAgICAgIG5ld1Bhc3N3b3JkOiBbeyB2YWxpZGF0b3I6IHZhbGlkYXRlUGFzcywgdHJpZ2dlcjogImJsdXIiIH1dLAogICAgICAgIGNoZWNrUGFzc3dvcmQ6IFt7IHZhbGlkYXRvcjogdmFsaWRhdGVQYXNzMiwgdHJpZ2dlcjogImJsdXIiIH1dLAogICAgICB9LAogICAgICBjdXJyZW50RGF0ZTonJywKICAgICAgdGltbWVyOicnCiAgICB9CiAgfSwKICBjb21wdXRlZDogewogICAgLi4ubWFwU3RhdGUoewogICAgICB1c2VyOiAoc3RhdGUpID0+IHN0YXRlLmxvZ2luLnVzZXIsCiAgICB9KSwKICAgIC8vIGN1cnJlbnREYXRlKCkgewogICAgLy8gICByZXR1cm4gbmV3IERhdGUoKS5wYXR0ZXJuKCJ5eXl5LU1NLWRkIGhoOm1tOnNzIik7CiAgICAvLyB9LAogIH0sCiAgbWV0aG9kczogewogICAgZGVhbFVzZXIoY29tbWFuZCkgewogICAgICBpZiAoY29tbWFuZCA9PT0gImxvZ291dCIpIHsKICAgICAgICB0aGlzLiRjb25maXJtKCLmmK/lkKbnoa7orqTpgIDlh7o/IiwgIumAgOWHuiIsIHsKICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAi56Gu6K6kIiwKICAgICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICLlj5bmtogiLAogICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgY2VudGVyOiB0cnVlLAogICAgICAgICAgc2hvd0Nsb3NlOiBmYWxzZSwKICAgICAgICB9KQogICAgICAgICAgLnRoZW4oKCkgPT4gewogICAgICAgICAgICB0aGlzLnJlc2V0VXNlcigpOwogICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgICAgICAgcGF0aDogIi9sb2dpbiIsCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSkKICAgICAgICAgIC5jYXRjaCgoKSA9PiB7fSk7CiAgICAgIH0KICAgICAgaWYgKGNvbW1hbmQgPT0gImNoYW5nZVB3ZCIpIHsKICAgICAgICB0aGlzLmRpYWxvZ0Zvcm1WaXNpYmxlID0gdHJ1ZTsKICAgICAgfQogICAgfSwKICAgIHJlc2V0VXNlcigpIHsKICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goImxvZ2luL3NldFVzZXIiLCB7fSk7CiAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCJsb2dpbi9zZXRUb2tlbiIsICIiKTsKICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goImxvZ2luL3NldFJvdXRlciIsICIiKTsKICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goInN5c3RlbS9zZXRQYXRoIiwgIiIpOwogICAgfSwKICAgIGNoYW5nZVB3ZCgpewogICAgICAvL+S/ruaUueWvhueggQogICAgICB0aGlzLiRyZWZzLnJ1bGVGb3JtLnZhbGlkYXRlKCh2YWxpZCkgPT4gewogICAgICAgIGlmKHZhbGlkKXsKICAgICAgICAgIHRoaXMuJGF4aW9zKHsKICAgICAgICAgICAgdXJsOicvYXBpLWFkbWluL3VzZXIvdXBkYXRlUGFzc3dvcmQnLAogICAgICAgICAgICB0eXBlOidwb3N0JywKICAgICAgICAgICAgZGF0YTp7CiAgICAgICAgICAgICAgaWQ6dGhpcy51c2VyLmlkLAogICAgICAgICAgICAgIG9sZFBhc3N3b3JkOnRoaXMuZm9ybS5vbGRQYXNzd29yZCwKICAgICAgICAgICAgICBwYXNzd29yZDp0aGlzLmZvcm0ubmV3UGFzc3dvcmQKICAgICAgICAgICAgfQogICAgICAgICAgfSkudGhlbihyZXMgPT4gewogICAgICAgICAgICBsZXQge2NvZGUsbXNnfSA9cmVzOwogICAgICAgICAgICBpZihjb2RlICE9IDApIHJldHVybiB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgICAgICB0eXBlOidlcnJvcicsCiAgICAgICAgICAgICAgbWVzc2FnZTptc2cgfHwgJ+S/ruaUueWvhueggeWksei0pScKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICAgIHR5cGU6J3N1Y2Nlc3MnLAogICAgICAgICAgICAgIG1lc3NhZ2U6bXNnIHx8ICfkv67mlLnlr4bnoIHmiJDlip8nCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB0aGlzLmRpYWxvZ0Zvcm1WaXNpYmxlID0gZmFsc2UKICAgICAgICAgIH0pLmNhdGNoKGVyciA9PiB7CiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICAgIHR5cGU6J2Vycm9yJywKICAgICAgICAgICAgICBtZXNzYWdlOmVyci5tc2cgfHwgJ+S/ruaUueWvhueggeWksei0pScKICAgICAgICAgICAgfSkKICAgICAgICAgIH0pCiAgICAgICAgfQogICAgICB9KQogICAgICAKICAgIH0KICB9LAogIGNyZWF0ZWQgKCkgewogICAgdGhpcy50aW1tZXI9c2V0SW50ZXJ2YWwoKCk9PnsKICAgICAgdGhpcy5jdXJyZW50RGF0ZSA9IG5ldyBEYXRlKCkucGF0dGVybigieXl5eS1NTS1kZCBoaDptbTpzcyIpOwogICAgfSwxMDAwKQogIH0sCiAgYmVmb3JlRGVzdHJveSAoKSB7CiAgICBjbGVhckludGVydmFsKHRoaXMudGltbWVyKTsKICB9Cn07Cg=="},{"version":3,"sources":["navbar.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"navbar.vue","sourceRoot":"src/pages/layout","sourcesContent":["<template>\n  <div class=\"navbar\">\n    <div class=\"company\">\n      <!-- <div class=\"company-logo\"></div> -->\n      <div class=\"company-name\">豫力汽配智慧管控系统</div>\n    </div>\n    <div class=\"user\">\n      <div class=\"time\">{{ currentDate }}</div>\n      <div class=\"user-icon\"></div>\n      <div class=\"user-name\">\n        <el-dropdown trigger=\"hover\" @command=\"dealUser\">\n          <span class=\"el-dropdown-link\">\n            {{ user.username }}\n            <i class=\"el-icon-arrow-down el-icon--right\"></i>\n          </span>\n          <el-dropdown-menu slot=\"dropdown\">\n            <el-dropdown-item command=\"changePwd\">修改密码</el-dropdown-item>\n            <el-dropdown-item command=\"logout\">退出</el-dropdown-item>\n          </el-dropdown-menu>\n        </el-dropdown>\n      </div>\n    </div>\n    <el-dialog title=\"修改密码\" :visible.sync=\"dialogFormVisible\" :center='true'>\n      <el-form :model=\"form\" :rules='rules' ref=\"ruleForm\">\n        <el-form-item label=\"旧密码\" :label-width=\"formLabelWidth\" prop='oldPassword'>\n          <el-input v-model=\"form.oldPassword\" autocomplete=\"off\" placeholder=\"请输入旧密码\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"新密码\" :label-width=\"formLabelWidth\" prop='newPassword'>\n          <el-input show-password v-model=\"form.newPassword\" autocomplete=\"off\" placeholder=\"请输入新密码\"></el-input>\n        </el-form-item>\n         <el-form-item label=\"确认新密码\" :label-width=\"formLabelWidth\" prop='checkPassword'>\n          <el-input show-password v-model=\"form.checkPassword\" autocomplete=\"off\" placeholder=\"请再次输入新密码\"></el-input>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"changePwd\"\n          >确 认</el-button\n        >\n      </div>\n    </el-dialog>\n  </div>\n</template>\n<script>\nimport { mapState } from \"vuex\";\nexport default {\n  data () {\n    let validatePass = (rule, value, callback) => {\n      if (value === \"\") {\n        callback(new Error(\"请输入新密码\"));\n      } else {\n        if (this.form.checkPassword !== \"\") {\n          this.$refs.ruleForm.validateField(\"checkPass\");\n        }\n        callback();\n      }\n    };\n    let validatePass2 = (rule, value, callback) => {\n      if (value === \"\") {\n        callback(new Error(\"请再次输入密码\"));\n      } else if (value !== this.form.newPassword) {\n        callback(new Error(\"两次输入密码不一致!\"));\n      } else {\n        callback();\n      }\n    };\n    return {\n      dialogFormVisible:false,\n      formLabelWidth:'100px',\n      form:{\n        oldPassword: '',\n        newPassword:'',\n        checkPassword:''\n      },\n      rules:{\n        oldPassword: [{required:true,trigger:'blur',message:'请输入旧密码'}],\n        newPassword: [{ validator: validatePass, trigger: \"blur\" }],\n        checkPassword: [{ validator: validatePass2, trigger: \"blur\" }],\n      },\n      currentDate:'',\n      timmer:''\n    }\n  },\n  computed: {\n    ...mapState({\n      user: (state) => state.login.user,\n    }),\n    // currentDate() {\n    //   return new Date().pattern(\"yyyy-MM-dd hh:mm:ss\");\n    // },\n  },\n  methods: {\n    dealUser(command) {\n      if (command === \"logout\") {\n        this.$confirm(\"是否确认退出?\", \"退出\", {\n          confirmButtonText: \"确认\",\n          cancelButtonText: \"取消\",\n          type: \"warning\",\n          center: true,\n          showClose: false,\n        })\n          .then(() => {\n            this.resetUser();\n            this.$router.push({\n              path: \"/login\",\n            });\n          })\n          .catch(() => {});\n      }\n      if (command == \"changePwd\") {\n        this.dialogFormVisible = true;\n      }\n    },\n    resetUser() {\n      this.$store.dispatch(\"login/setUser\", {});\n      this.$store.dispatch(\"login/setToken\", \"\");\n      this.$store.dispatch(\"login/setRouter\", \"\");\n      this.$store.dispatch(\"system/setPath\", \"\");\n    },\n    changePwd(){\n      //修改密码\n      this.$refs.ruleForm.validate((valid) => {\n        if(valid){\n          this.$axios({\n            url:'/api-admin/user/updatePassword',\n            type:'post',\n            data:{\n              id:this.user.id,\n              oldPassword:this.form.oldPassword,\n              password:this.form.newPassword\n            }\n          }).then(res => {\n            let {code,msg} =res;\n            if(code != 0) return this.$message({\n              type:'error',\n              message:msg || '修改密码失败'\n            });\n            this.$message({\n              type:'success',\n              message:msg || '修改密码成功'\n            });\n            this.dialogFormVisible = false\n          }).catch(err => {\n            this.$message({\n              type:'error',\n              message:err.msg || '修改密码失败'\n            })\n          })\n        }\n      })\n      \n    }\n  },\n  created () {\n    this.timmer=setInterval(()=>{\n      this.currentDate = new Date().pattern(\"yyyy-MM-dd hh:mm:ss\");\n    },1000)\n  },\n  beforeDestroy () {\n    clearInterval(this.timmer);\n  }\n};\n</script>\n\n<style lang=\"less\" scoped>\n// @import \"../../assets/fonts/font.css\";\n\n.navbar {\n  display: flex;\n  flex-direction: row;\n  height: 80px;\n  background-color: #00b9ed;\n  color: #fff;\n  justify-content: space-between;\n}\n\n.company {\n  display: flex;\n\n  align-items: center;\n\n  &-logo {\n    width: 60px;\n    height: 60px;\n    margin: 10px 20px;\n    background: url(../../assets/images/logo.png) no-repeat;\n    background-size: 100% 100%;\n  }\n\n  &-name {\n    margin: 0 0 0 10px;\n    font-family: \"ALIHYAIHEI\";\n    font-size: 28px;\n  }\n}\n\n.user {\n  display: flex;\n  padding: 10px 20px;\n\n  align-items: center;\n  .time {\n    margin-right: 60px;\n    font-weight: 700;\n  }\n  &-icon {\n    width: 40px;\n    height: 40px;\n    margin: 10px 20px 10px 10px;\n    background: url(../../assets/images/avatar.png) no-repeat;\n    background-size: 100% 100%;\n  }\n\n  &-name {\n    cursor: pointer;\n  }\n  /deep/ .el-dropdown {\n    color: #fff;\n  }\n  /deep/ .el-dropdown-selfdefine {\n    font-size: 20px;\n    font-weight: 700;\n  }\n}\n</style>\n"]}]}