{"remainingRequest":"/Users/apple/Desktop/vueprototype/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/apple/Desktop/vueprototype/src/pages/admin/department/manage/index.vue?vue&type=style&index=0&id=ee08db9e&lang=less&scoped=true&","dependencies":[{"path":"/Users/apple/Desktop/vueprototype/src/pages/admin/department/manage/index.vue","mtime":1599616394000},{"path":"/Users/apple/Desktop/vueprototype/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/apple/Desktop/vueprototype/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/apple/Desktop/vueprototype/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/apple/Desktop/vueprototype/node_modules/less-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/apple/Desktop/vueprototype/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/apple/Desktop/vueprototype/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5kZXBhcnRtZW50IHsKICBwYWRkaW5nOiAyMHB4OwogIC5vcGVyYXRvcnMsCiAgLm9wZXJhdG9ycyAuc2VhcmNoIHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgfQogIC50YWJsZS1saXN0IHsKICAgIG1hcmdpbjogMjBweCAwIDAgMDsKICAgIGJhY2tncm91bmQ6ICNmZmY7CiAgICBwYWRkaW5nLXRvcDogMjBweDsKICAgIC5lbC1idXR0b257CiAgICAgIG1hcmdpbi1ib3R0b206MjBweDsKICAgIH0KICB9CiAgLm9wZXJhdG9ycyAvZGVlcC8gLmVsLWlucHV0IHsKICAgIHdpZHRoOiAyNTBweDsKICB9CiAgLnBhZ2luYXRpb24gewogICAgcGFkZGluZzogNTBweDsKICAgIHRleHQtYWxpZ246IGNlbnRlcjsKICAgIGJhY2tncm91bmQtY29sb3I6ICNmZmY7CiAgfQogIC9kZWVwLyAuZWwtYnV0dG9uIHsKICAgIG1hcmdpbjogMCAwIDAgMjBweDsKICB9Cn0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/pages/admin/department/manage","sourcesContent":["<template>\n  <div class=\"department\">\n    <div class=\"operators\">\n      <div class=\"search\">\n        <el-input type=\"text\" v-model.trim=\"key\" placeholder=\"请输入部门名称\"></el-input>\n        <el-button type=\"primary\" size=\"mini\" @click=\"search\">搜索</el-button>\n      </div>\n    </div>\n    <div class=\"table-list\">\n      <el-button type=\"primary\" size=\"small\" @click=\"newAdd\">部门新增</el-button>\n      <el-table\n        :data=\"table\"\n        style=\"padding: 0 20px;box-sizing: border-box\"\n        row-key=\"id\"\n        :default-expand-all=\"false\"\n        :tree-props=\"{children: 'children', hasChildren: 'hasChildren'}\"\n         header-row-class-name=\"headerRow\"\n        :header-cell-style=\"{ background: '#eef1f6', color: '#606266' }\"\n      >\n        <el-table-column prop=\"name\" label=\"部门名称\" width=\"180\"></el-table-column>\n        <el-table-column prop=\"createDate\" align=\"center\" label=\"创建时间\" sortable width=\"180\"></el-table-column>\n        <el-table-column prop=\"remarks\" align=\"center\" label=\"备注\"></el-table-column>\n        <el-table-column label=\"操作\" align=\"center\">\n          <template #default=\"{row}\">\n            <el-button v-if=\"!row.parentId\" type=\"primary\" size=\"mini\" @click=\"add(row)\">新增</el-button>\n            <el-button type=\"primary\" size=\"mini\" @click=\"edit(row)\">编辑</el-button>\n            <el-button type=\"warning\" size=\"mini\" @click=\"del(row)\">删除</el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n    </div>\n    <cdialog v-if=\"showDepartmentManage\"></cdialog>\n    <div class=\"pagination\">\n      <el-pagination\n        @size-change=\"handleSizeChange\"\n        @current-change=\"handleCurrentChange\"\n        :current-page=\"page\"\n        :page-sizes=\"[10, 20, 30, 40]\"\n        :page-size=\"limit\"\n        layout=\"total, sizes, prev, pager, next, jumper\"\n        :total=\"total\"\n      ></el-pagination>\n    </div>\n  </div>\n</template>\n\n<script>\nimport dialog from \"@/components/department/manage/dialog\";\nexport default {\n  components: { cdialog: dialog },\n  data() {\n    return {\n      key: \"\",\n      table: [],\n      page: 1,\n      limit: 10,\n      total: 0,\n      // 展示弹框\n      showDepartmentManage: false\n    };\n  },\n  events: {\n    getDepartmentManage({ id, parentId = 0, name, remarks }) {\n      if (id) {\n        this.editSubmit({ id, parentId, name, remarks });\n        return;\n      }\n      this.addSubmit({ parentId, name, remarks });\n    },\n    closeDepartmentManageDialog() {\n      this.showDepartmentManage = false;\n    }\n  },\n  methods: {\n    handleSizeChange(pageSize) {\n      this.limit = pageSize;\n      this.search();\n    },\n    handleCurrentChange(current) {\n      this.page = current;\n      this.search();\n    },\n    search() {\n      this.$axios({\n        url: \"/api-admin/dept/list\",\n        type: \"get\",\n        data: {\n          page: this.page,\n          limit: this.limit,\n          name: this.key\n        }\n      })\n        .then(res => {\n          const page = (res || {}).page || {};\n          this.table = page.rows || [];\n          this.total = +page.total;\n        })\n        .catch(err => {\n          this.$message({\n            message: err.msg || \"获取部门列表失败\"\n          });\n        });\n    },\n    newAdd() {\n      this.showDepartmentManage = true;\n      this.$nextTick(_ => {\n        this.$trigger(\"newDialog\", 1, { id: 0 });\n      });\n    },\n    addSubmit({ parentId, name, remarks }) {\n      this.$axios({\n        url: \"/api-admin/dept/add\",\n        type: \"post\",\n        data: {\n          parentId:parentId || 0,\n          name,\n          remarks\n        }\n      })\n        .then(res => {\n          this.showDepartmentManage = false;\n          this.search();\n        })\n        .catch(err => {\n          this.$message({\n            message: err.msg || \"新增部门失败\"\n          });\n        });\n    },\n    add(row) {\n      this.showDepartmentManage = true;\n      this.$nextTick(_ => {\n        this.$trigger(\"newDialog\", 2, row);\n      });\n    },\n    edit(row) {\n      this.showDepartmentManage = true;\n      this.$nextTick(_ => {\n        this.$trigger(\"editDepartmentManage\", row);\n      });\n    },\n    editSubmit({ id, parentId, name, remarks }) {\n      this.$axios({\n        url: \"/api-admin/dept/update\",\n        type: \"post\",\n        data: {\n          id,\n          parentId,\n          name,\n          remarks\n        }\n      })\n        .then(res => {\n          this.showDepartmentManage = false;\n          this.search();\n        })\n        .catch(err => {\n          this.$message({\n            message: err.msg || \"更新失败\"\n          });\n        });\n    },\n    del({ id }) {\n      this.$confirm(\"是否确认删除此部门?\", \"安全提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\"\n      })\n        .then(() => {\n          this.$axios({\n            url: \"/api-admin/dept/delete\",\n            type: \"post\",\n            data: {\n              id\n            }\n          })\n            .then(res => {\n              this.$message({\n                type: \"success\",\n                message: \"删除成功!\"\n              });\n              this.search();\n            })\n            .catch(err => {\n              this.$message({\n                message: err.msg || \"删除失败\"\n              });\n            });\n        })\n        .catch(() => {});\n    }\n  },\n  created() {\n    this.search();\n  }\n};\n</script>\n\n<style lang=\"less\" scoped>\n.department {\n  padding: 20px;\n  .operators,\n  .operators .search {\n    display: flex;\n  }\n  .table-list {\n    margin: 20px 0 0 0;\n    background: #fff;\n    padding-top: 20px;\n    .el-button{\n      margin-bottom:20px;\n    }\n  }\n  .operators /deep/ .el-input {\n    width: 250px;\n  }\n  .pagination {\n    padding: 50px;\n    text-align: center;\n    background-color: #fff;\n  }\n  /deep/ .el-button {\n    margin: 0 0 0 20px;\n  }\n}\n</style>"]}]}